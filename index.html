<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=1024, user-scalable=no">

    <title>WebGIS with vector data using OpenLayers &amp; GeoExt</title>
    
    <!-- Required stylesheet -->
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/core/deck.core.css">
    
    <!-- Extension CSS files go here. Remove or add as needed. -->
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/goto/deck.goto.css">
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/menu/deck.menu.css">
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/navigation/deck.navigation.css">
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/status/deck.status.css">
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/hash/deck.hash.css">
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/extensions/scale/deck.scale.css">

    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/themes/style/web-2.0.css">
    
    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" type="text/css" href="./resources/imakewebthings-deck.js-069f632/themes/transition/horizontal-slide.css">
    
    <!-- Required Modernizr file -->
    <script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/modernizr.custom.js"></script>
    
    <!-- load our Ext, OpenLayers and configure GeoExt -->
    <script type="text/javascript" src="./resources/extjs-4.1.1/ext-debug.js"></script>
    <script type="text/javascript" src="./resources/openlayers-openlayers-ec26dd6/lib/OpenLayers.js"></script>
    <script type="text/javascript">
    Ext.Loader.setConfig({
        enabled: true,
        disableCaching: false,
        paths: {
            GeoExt: "./resources/geoext-geoext2-aef9c2a/src/GeoExt",
            Ext: "./resources/extjs-4.1.1/src"
        }
    });
    </script>
    
    <style type="text/css"> 
#title h1 {
    top: 40%
}
#author {
    position: absolute;
    bottom: 2%;
    right:  2%;
    font-size: 50px;
    color: #444;
    font-family: "LMSansDemiCond10", sans-serif;
}
#author a {
    text-decoration: none;
    color: #444;
    font-family: "Courier", monospace;
}

ul, ul ul {
    list-style-type:none;
}

.slide ul li {
    font-size: 170%;
    font-weight: bold;
    font-family: "LMSansDemiCond10", sans-serif;
    letter-spacing: 0.05em;
}

.slide ul li ul li {
    font-size: 100%;
}

.sideimage-right {
    width: 350px;
    position: absolute;
    top: 1em;
    right: 1em;
}

.deck-running-time {
    position: absolute;
    left: 0.3em;
    bottom: 0.3em;
    color: #555;
    text-shadow: 1px 1px 1px #fff;
    font-size: 15px;
}
.deck-running-time-exceeded {
    color: #f00;
}

div.aside-right {
    width: 20em;
    height: 12em;
    position: absolute;
    right: 2em;
    top: 4em;
}
    </style>
</head>

<body class="deck-container">

<!-- Begin slides. Just make elements with a class of slide. -->

<div class="slide" id="title">
    <h1>WebGIS with vector data using OpenLayers &amp; GeoExt</h1>
    <h2 id="author">Marc Jansen, terrestris 
    <a href="mailto:jansen@terrestris.de">&lt;jansen@terrestris.de&gt;</a>
    </h2>
</div>

<!--
<div class="slide">
    <h1>Content</h1>
</div>
-->

<div class="slide" id="content">
    <h2>Content</h2>
    <ul>
        <li>Introduction</li>
        <li>OpenLayers</li>
        <li>GeoExt</li>
        <li>Outlook</li>
    </ul>
</div>

<div class="slide">
    <h1>Introduction</h1>
</div>

<div class="slide" id="about-me">
    <h2>About me</h2>
    <ul>
        <li>developer @terrestris</li>
        <li>mainly JavaScript (recently also Java)</li>
        <li>book author</li>
        <li>core developer of OpenLayers</li>
        <li>one of the kickstarters of GeoExt 2</li>
    </ul>
    <img src="./resources/img/openlayers-book.jpg" 
        class="sideimage-right"
        alt="OpenLayers book">
</div>

<div class="slide" id="about-terrestris">
    <h2>About terrestris</h2>
    <ul>
        <li>based in Bonn, Germany</li>
        <li>top-notch WebGIS</li>
        <li>standards enthusiasts</li>
        <li>OpenSource / Free software</li>
        <li>development, training, consulting</li>
    </ul>
</div>

<div class="slide" id="about-the-talk">
    <h2>About the talk</h2>
    <ul>
        <li>OpenLayers is huge</li>
        <li>so is GeoExt</li>
        <li><em>highlights</em> of both libraries</li>
        <li>... all in relation to vector data</li>
        <li>a hell of a ride</li>
    </ul>
</div>

<div class="slide">
    <h1>OpenLayers</h1>
</div>

<div class="slide" id="openlayers-overview">
    <h2>Overview</h2>
    <ul>
        <li>a very popular JavaScript library for web-maps</li>
        <li>OpenSource (BSD), &copy; OSGeo </li>
        <li>long history (dating back to 2006)</li>
        <li>used in lots of important projects</li>
        <li>understands lots of formats</li>
        <li>provides a common API</li>
    </ul>
</div>

<div class="slide" id="openlayers-example">
    <h2>Example</h2>
    <img src="./resources/img/fix-me.png" 
        alt="OpenLayers example">
</div>

<div class="slide" id="openlayers-vector-data">
    <h2>OpenLayers and vector data</h2>
    <ul>
        <li>fetching</li>
        <li>displaying</li>
        <li>styling</li>
        <li>modifying</li>
        <li>persisting</li>
    </ul>
</div>

<div class="slide" id="openlayers-vector-data-fetching">
    <h2>fetching &amp; reading vector data</h2>
    <ul>
        <li>OpenLayers.Protocol</li>
        <li>WFS, HTTP, &hellip;</li>
    </ul>
    <ul>
        <li>OpenLayers.Format</li>
        <li>GML, KML, GeoJson, &hellip;</li>
    </ul>
    <div class="aside-right" id="ol-formats"></div>
</div>

<div class="slide" id="openlayers-vector-data-displaying">
    <h2>displaying vector data</h2>
    <ul>
        <li>SVG</li>
        <li>Canvas</li>
        <li>VML</li>
        <li><strike>SVG2</strike></li>
        <li>normalized interaction</li>
    </ul>
    <div class="aside-right" id="ol-renderer-canvas"></div>
</div>

<div class="slide" id="openlayers-vector-data-styling">
    <h2>styling vector data</h2>
    <ul>
        <li>cross-renderer</li>
        <li>feature-attribute based</li>
        <li>context based</li>
        <li>render-intend based</li>
    </ul>
    <div class="aside-right" id="ol-vector-style"></div>
</div>

<div class="slide" id="openlayers-vector-data-modifying">
    <h2>modifying vector data</h2>
    <ul>
        <li>editing controls (CUD)</li>
        <li>snapping / splitting</li>
        <li>clustering</li>
        <li>simplification</li>
    </ul>
    <div class="aside-right" id="ol-vector-simplified"></div>
</div>

<div class="slide" id="openlayers-vector-data-persisting">
    <h2>persisting vector data</h2>
    <ul>
        <li>persisting via WFS-T</li>
        <li>other outputformats</li>
    </ul>
</div>

<div class="slide" id="openlayers-vector-performance">
    <h2>performance</h2>
    <ul>
        <li>renderer dependant</li>
        <li>basically sufficient / satisfying</li>
        <li>room for improvement</li>
    </ul>
</div>

<div class="slide">
    <h1>GeoExt</h1>
</div>

<div class="slide" id="geoext-overview">
    <h2>Overview</h2>
    <ul>
        <li>rich web mapping interfaces</li>
        <li>extends Ext JS with spatial components</li>
        <li>OpenSource (BSD, exception from Sencha), &copy; OSGeo</li>
    </ul>
</div>

<div class="slide" id="geoext-example">
    <h2>Example</h2>
    <img src="./resources/img/fix-me.png" 
        alt="GeoExt example">
</div>

<div class="slide" id="geoext-vector-data-part-1">
    <h2>GeoExt and vector data</h2>
    <ul>
        <li>data components</li>
        <li>form components</li>
        <li>UI enhancements</li>
    </ul>
</div>

<div class="slide" id="geoext-data-components">
    <h2>GeoExt data components</h2>
    <ul>
        <li>proxy for OpenLayers.Protocol objects</li>
        <li>readers for e.g. features and attributes</li>
        <li>models for e.g. WFS GetCapabilities (discovery)</li>
        <li>stores that combine the aforementioned</li>
    </ul>
</div>

<div class="slide" id="geoext-form-components">
    <h2>GeoExt form components</h2>
    <ul>
        <li>can combine a proxy (with OpenLayer.Protocol)</li>
        <li>with an OpenLayers.Filter</li>
        <li>generated from a standard form</li>
        <li>e.g. for querying a WFS</li>
    </ul>
</div>

<div class="slide" id="geoext-form-components">
    <h2>GeoExt UI enhancements</h2>
    <ul>
        <li>VectorRenderer
            <ul>
                <li>OpenLayers.Style to Ext.Component</li>
                <li>used e.g. in legends</li>
                <li>or in feature grids</li>
            </ul>
        </li>
        <li>interactive print selection</li>
        <li>highlighting features (grid &hArr; map)</li>
    </ul>
</div>

<div class="slide">
    <h1>Outlook</h1>
</div>

<div class="slide">
    <h2>OpenLayers 3</h2>
    <ul>
        <li>WebGL</li>
        <li>performance</li>
        <li>file size</li>
        <li>better API-docs</li>
    </ul>
</div>

<div class="slide">
    <h2>GeoExt 2</h2>
    <ul>
        <li>not too far from final</li>
        <li>chart interactions</li>
    </ul>
    <ul>
        <li>GeoExt next: OpenLayers 3 ?</li>
    </ul>
</div>


<div class="slide" id="thanks-questions">
    <h2>Thank you</h2>
    <h1>Questions?</h1>
</div>

<div class="slide" id="imprint">
    <h2>Imprint</h2>
    <h3>Author</h3>
    <address>
        Marc Jansen<br />
        jansen@terrestris.de
    </address>
    <p>
        (twitter) @selectoid<br />
        (github) @marcjansen
    </p>
    <h3>License</h3>
    <p>
        These slides are 
        <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA</a>.
    </p>
</div>

<!-- End slides. -->


<!-- Begin extension snippets. Add or remove as needed. -->

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet -->
<p class="deck-status">
    <span class="deck-status-current"> </span>
    /
    <span class="deck-status-total"> </span>
</p>

<!-- deck.goto snippet -->
<form action="." method="get" class="goto-form">
    <label for="goto-slide">Go to slide:</label>
    <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
    <datalist id="goto-datalist"></datalist>
    <input type="submit" value="Go">
</form>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

<div class="deck-running-time">&nbsp;</div>

<!-- End extension snippets. -->

<!-- Required JS files. -->
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/hash/deck.hash.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/time/deck.time.uglified.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/menu/deck.menu.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/goto/deck.goto.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/status/deck.status.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/navigation/deck.navigation.js"></script>
<script type="text/javascript" src="./resources/imakewebthings-deck.js-069f632/extensions/scale/deck.scale.js"></script>

<!-- Initialize the deck. You can put this in an external file if desired. -->
<script type="text/javascript" >
    jQuery(function() {
        jQuery.deck('.slide');
        OpenLayers.ProxyHost = "/cgi-bin/proxy.cgi?url="
        var geographic = new OpenLayers.Projection("EPSG:4326");
        var mercator = new OpenLayers.Projection("EPSG:900913");
        var swissCenterGeogr = new OpenLayers.LonLat(8.2153826,46.79902293);
        swissCenterMerc = swissCenterGeogr.clone().transform(geographic, mercator);
    
        var map1 = new OpenLayers.Map('ol-formats', {
            allOverlays: true,
            projection: mercator,
            layers: [
                new OpenLayers.Layer.OSM(),
                new OpenLayers.Layer.Vector("wfs", {
                    strategies: [new OpenLayers.Strategy.BBOX()],
                    protocol: new OpenLayers.Protocol.WFS({
                        url:  "http://ows.terrestris.de/geoserver/terrestris/wfs",
                        featureType: "world-countries-shape",
                        featureNS: "http://terrestris.de"
                    }),
                    filter: new OpenLayers.Filter.Comparison({
                        type: OpenLayers.Filter.Comparison.EQUAL_TO,
                        property: "iso_a2",
                        value: "CH"
                    }),
                    projection: geographic,
                    style: new OpenLayers.Util.applyDefaults({
                        fillOpacity: 0.3,
                        fillColor: '#ccc',
                        strokeColor: '#d00',
                        strokeWidth: 3,
                        strokeDashstyle: 'solid',
                        label: "Switzerland"
                    }, OpenLayers.Feature.Vector.style['default']),
                    renderers: ['SVG', 'Canvas', 'VML'] // optional this is the default also
                })
            ],
            controls: [new OpenLayers.Control.Navigation()],
            center: swissCenterMerc,
            zoom: 7
        });
        
        var map2 = new OpenLayers.Map('ol-renderer-canvas', {
            allOverlays: true,
            projection: mercator,
            layers: [
                new OpenLayers.Layer.OSM(),
                new OpenLayers.Layer.Vector("wfs", {
                    strategies: [new OpenLayers.Strategy.BBOX()],
                    protocol: new OpenLayers.Protocol.WFS({
                        url:  "http://ows.terrestris.de/geoserver/terrestris/wfs",
                        featureType: "world-countries-shape",
                        featureNS: "http://terrestris.de"
                    }),
                    filter: new OpenLayers.Filter.Comparison({
                        type: OpenLayers.Filter.Comparison.EQUAL_TO,
                        property: "iso_a2",
                        value: "CH"
                    }),
                    projection: geographic,
                    style: new OpenLayers.Util.applyDefaults({
                        fillOpacity: 0.3,
                        fillColor: '#ccc',
                        strokeColor: '#d00',
                        strokeWidth: 3,
                        strokeDashstyle: 'solid',
                        label: "Switzerland"
                    }, OpenLayers.Feature.Vector.style['default']),
                    renderers: ['Canvas', 'SVG', 'VML']
                })
            ],
            controls: [new OpenLayers.Control.Navigation()],
            center: swissCenterMerc,
            zoom: 7
        });
        
        var map3 = new OpenLayers.Map('ol-vector-style', {
            allOverlays: true,
            projection: mercator,
            layers: [
                new OpenLayers.Layer.OSM(),
                new OpenLayers.Layer.Vector("wfs", {
                    strategies: [new OpenLayers.Strategy.BBOX()],
                    protocol: new OpenLayers.Protocol.WFS({
                        url:  "http://ows.terrestris.de/geoserver/terrestris/wfs",
                        featureType: "world-countries-shape",
                        featureNS: "http://terrestris.de"
                    }),
                    filter: new OpenLayers.Filter.Comparison({
                        type: OpenLayers.Filter.Comparison.EQUAL_TO,
                        property: "iso_a2",
                        value: "CH"
                    }),
                    projection: geographic,
                    style: new OpenLayers.Util.applyDefaults({
                        fillOpacity: 0.3,
                        fillColor: '#e0e',
                        strokeColor: '#0e0',
                        strokeWidth: 5,
                        strokeDashstyle: 'solid',
                        labelOutlineColor: 'orange',
                        labelOutlineWidth: 4,
                        fontColor: '#e00',
                        fontFamily: 'Squealer Embossed',
                        label: "Switzerland"
                    }, OpenLayers.Feature.Vector.style['default'])
                })
            ],
            controls: [new OpenLayers.Control.Navigation()],
            center: swissCenterMerc,
            zoom: 7
        });
        
        // ol-vector-simplified,
        var map4 = new OpenLayers.Map('ol-vector-simplified', {
            allOverlays: true,
            projection: mercator,
            layers: [
                new OpenLayers.Layer.OSM(),
                new OpenLayers.Layer.Vector("wfs", {
                    strategies: [new OpenLayers.Strategy.BBOX()],
                    protocol: new OpenLayers.Protocol.WFS({
                        url:  "http://ows.terrestris.de/geoserver/terrestris/wfs",
                        featureType: "world-countries-shape",
                        featureNS: "http://terrestris.de"
                    }),
                    filter: new OpenLayers.Filter.Comparison({
                        type: OpenLayers.Filter.Comparison.EQUAL_TO,
                        property: "iso_a2",
                        value: "CH"
                    }),
                    projection: geographic,
                    style: new OpenLayers.Util.applyDefaults({
                        fillOpacity: 0.3,
                        fillColor: '#ccc',
                        strokeColor: '#d00',
                        strokeWidth: 5,
                        strokeDashstyle: 'solid'
                    }, OpenLayers.Feature.Vector.style['default'])
                })
            ],
            controls: [new OpenLayers.Control.Navigation()],
            center: swissCenterMerc,
            zoom: 7
        });
        var simplify = function(evt){
            if (map4.layers[1].features.length >=2 ) {
                console.log('unregister');
                map4.layers[1].events.unregister('featureadded', map4, simplify);
            }
            var points = evt.feature.geometry.getVertices();
            var ls = new OpenLayers.Geometry.LineString(points).simplify(10000);
            map4.layers[1].addFeatures([new OpenLayers.Feature.Vector(
                new OpenLayers.Geometry.MultiPolygon(
                    new OpenLayers.Geometry.Polygon(
                        new  OpenLayers.Geometry.LinearRing(ls.getVertices())
                    )
                )
            )], null, new OpenLayers.Style(new OpenLayers.Util.applyDefaults({
                fill: false,
                strokeColor: '#f00',
                strokeWidth: 5,
                strokeDashstyle: 'solid'
            }, OpenLayers.Feature.Vector.style['default'])));
            map4.layers[1].removeFeatures([map4.layers[1].features[0]])
        };
        map4.layers[1].events.register('featureadded', map4, simplify);
        map4.addControl(new OpenLayers.Control.ModifyFeature(map4.layers[1], {
            autoActivate: true
        }));
    });
</script>
</body>
</html>
